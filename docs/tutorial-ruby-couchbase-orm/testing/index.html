<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorial-ruby-couchbase-orm/testing" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">Testing | Ruby Couchbase ORM</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://couchbase-examples.github.io/ruby-couchbase-orm-quickstart/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://couchbase-examples.github.io/ruby-couchbase-orm-quickstart/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://couchbase-examples.github.io/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/testing"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Testing | Ruby Couchbase ORM"><meta data-rh="true" name="description" content="Testing is an essential part of developing robust and maintainable applications. CouchbaseOrm provides support for testing your models and queries to ensure they behave as expected. In this section, we&#x27;ll explore how to set up and write tests for your CouchbaseOrm-based application."><meta data-rh="true" property="og:description" content="Testing is an essential part of developing robust and maintainable applications. CouchbaseOrm provides support for testing your models and queries to ensure they behave as expected. In this section, we&#x27;ll explore how to set up and write tests for your CouchbaseOrm-based application."><link data-rh="true" rel="icon" href="/ruby-couchbase-orm-quickstart/img/logo.svg"><link data-rh="true" rel="canonical" href="https://couchbase-examples.github.io/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/testing"><link data-rh="true" rel="alternate" href="https://couchbase-examples.github.io/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/testing" hreflang="en"><link data-rh="true" rel="alternate" href="https://couchbase-examples.github.io/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/testing" hreflang="x-default"><link rel="stylesheet" href="/ruby-couchbase-orm-quickstart/assets/css/styles.5d3acf1b.css">
<script src="/ruby-couchbase-orm-quickstart/assets/js/runtime~main.0d0e7fcf.js" defer="defer"></script>
<script src="/ruby-couchbase-orm-quickstart/assets/js/main.5d2dbcd4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ruby-couchbase-orm-quickstart/"><div class="navbar__logo"><img src="/ruby-couchbase-orm-quickstart/img/logo.svg" alt="Ruby Couchbase ORM Tutorial Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/ruby-couchbase-orm-quickstart/img/logo.svg" alt="Ruby Couchbase ORM Tutorial Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Ruby Couchbase ORM</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/ruby-couchbase-orm-quickstart/docs/category/tutorial---ruby-couchbase-orm">Tutorial</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/ruby-couchbase-orm-quickstart/docs/category/tutorial---ruby-couchbase-orm">Tutorial - Ruby Couchbase ORM</a><button aria-label="Collapse sidebar category &#x27;Tutorial - Ruby Couchbase ORM&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/installation">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/defining-models">Defining Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/querying">Querying</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/persistence">Persistence</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/associations-and-validations">Associations and Validations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/n1ql-queries">N1QL Queries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/views">Views</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/nested-documents">Nested Documents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/enums">Enums</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/encryption">Encryption</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/logging">Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/testing">Testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/advanced-topics">Advanced Topics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/troubleshooting">Troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/api-reference">API Reference</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/ruby-couchbase-orm-quickstart/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/ruby-couchbase-orm-quickstart/docs/category/tutorial---ruby-couchbase-orm"><span itemprop="name">Tutorial - Ruby Couchbase ORM</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Testing</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Testing</h1>
<p>Testing is an essential part of developing robust and maintainable applications. CouchbaseOrm provides support for testing your models and queries to ensure they behave as expected. In this section, we&#x27;ll explore how to set up and write tests for your CouchbaseOrm-based application.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="131-setup">13.1. Setup<a href="#131-setup" class="hash-link" aria-label="Direct link to 13.1. Setup" title="Direct link to 13.1. Setup">​</a></h2>
<p>To start testing your CouchbaseOrm models, you&#x27;ll need to set up your test environment. Here are the steps to get started:</p>
<ol>
<li>
<p><strong>Install testing dependencies</strong>: Make sure you have the necessary testing dependencies installed. If you&#x27;re using RSpec, you&#x27;ll need to add the <code>rspec</code> gem to your Gemfile:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">group :test do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gem &#x27;rspec&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Run <code>bundle install</code> to install the gem.</p>
</li>
<li>
<p><strong>Configure test environment</strong>: Create a configuration file for your test environment, specifying the Couchbase connection details and any other relevant settings:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># config/couchbase.yml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">test</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">host</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> localhost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">bucket</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> my_app_test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">username</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> my_username</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">password</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> my_password</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Make sure to use a separate bucket for testing to avoid modifying your development or production data.</p>
</li>
<li>
<p><strong>Initialize CouchbaseOrm</strong>: In your test setup, initialize CouchbaseOrm with the test configuration:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># spec/spec_helper.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">require &#x27;couchbase-orm&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CouchbaseOrm.configure do |config|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  config.load_config(File.join(File.dirname(__FILE__), &#x27;..&#x27;, &#x27;config&#x27;, &#x27;couchbase.yml&#x27;), :test)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This code loads the Couchbase configuration from the <code>config/couchbase.yml</code> file for the test environment.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="132-model-tests">13.2. Model Tests<a href="#132-model-tests" class="hash-link" aria-label="Direct link to 13.2. Model Tests" title="Direct link to 13.2. Model Tests">​</a></h2>
<p>Testing your CouchbaseOrm models involves verifying the behavior of your model classes, including attribute definitions, validations, callbacks, and associations. Here&#x27;s an example of testing a simple model:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># spec/models/user_spec.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">require &#x27;spec_helper&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RSpec.describe User do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  describe &#x27;validations&#x27; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    it &#x27;requires a name&#x27; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      user = User.new(email: &#x27;john@example.com&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      expect(user).to_not be_valid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      expect(user.errors[:name]).to include(&quot;can&#x27;t be blank&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    it &#x27;requires a valid email&#x27; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      user = User.new(name: &#x27;John Doe&#x27;, email: &#x27;invalid_email&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      expect(user).to_not be_valid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      expect(user.errors[:email]).to include(&#x27;is invalid&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  describe &#x27;callbacks&#x27; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    it &#x27;sets the status to active before saving&#x27; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      user = User.new(name: &#x27;John Doe&#x27;, email: &#x27;john@example.com&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      expect(user.status).to be_nil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      user.save</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      expect(user.status).to eq(&#x27;active&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, we test the validations and callbacks of the <code>User</code> model. We create instances of the model with different attributes and assert the expected behavior, such as validation errors and callback side effects.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="133-query-tests">13.3. Query Tests<a href="#133-query-tests" class="hash-link" aria-label="Direct link to 13.3. Query Tests" title="Direct link to 13.3. Query Tests">​</a></h2>
<p>Testing queries involves verifying that your CouchbaseOrm queries return the expected results. Here&#x27;s an example of testing a query:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># spec/queries/active_users_spec.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">require &#x27;spec_helper&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RSpec.describe &#x27;Active Users Query&#x27; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let!(:active_user) { User.create(name: &#x27;John&#x27;, status: &#x27;active&#x27;) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  let!(:inactive_user) { User.create(name: &#x27;Jane&#x27;, status: &#x27;inactive&#x27;) }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  it &#x27;returns only active users&#x27; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    active_users = User.where(status: &#x27;active&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    expect(active_users).to include(active_user)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    expect(active_users).to_not include(inactive_user)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, we create test data by creating instances of the <code>User</code> model with different statuses. We then execute the query to retrieve active users and assert that the query returns the expected results.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="134-mocking-couchbase-responses">13.4. Mocking Couchbase Responses<a href="#134-mocking-couchbase-responses" class="hash-link" aria-label="Direct link to 13.4. Mocking Couchbase Responses" title="Direct link to 13.4. Mocking Couchbase Responses">​</a></h2>
<p>In some cases, you may want to mock the responses from Couchbase to isolate your tests from the actual database. CouchbaseOrm integrates with popular mocking libraries like RSpec Mocks, allowing you to stub Couchbase responses.</p>
<p>Here&#x27;s an example of mocking a Couchbase response:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># spec/models/user_spec.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">require &#x27;spec_helper&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RSpec.describe User do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  describe &#x27;#find&#x27; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    it &#x27;returns the user when found&#x27; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      user_data = { &#x27;name&#x27; =&gt; &#x27;John Doe&#x27;, &#x27;email&#x27; =&gt; &#x27;john@example.com&#x27; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      allow(CouchbaseOrm::Connection.bucket).to receive(:get).with(&#x27;user_1&#x27;).and_return(user_data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      user = User.find(&#x27;user_1&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      expect(user.name).to eq(&#x27;John Doe&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      expect(user.email).to eq(&#x27;john@example.com&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, we use RSpec Mocks to stub the <code>CouchbaseOrm::Connection.bucket.get</code> method and return a predefined user data hash. This allows us to test the <code>find</code> method without actually querying the Couchbase database.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="135-test-helpers">13.5. Test Helpers<a href="#135-test-helpers" class="hash-link" aria-label="Direct link to 13.5. Test Helpers" title="Direct link to 13.5. Test Helpers">​</a></h2>
<p>To make your tests more readable and maintainable, you can create test helpers that encapsulate common setup or assertions. Here&#x27;s an example of a test helper:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># spec/support/model_helpers.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module ModelHelpers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def create_user(attributes = {})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    User.create({</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name: &#x27;John Doe&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      email: &#x27;john@example.com&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status: &#x27;active&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }.merge(attributes))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RSpec.configure do |config|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  config.include ModelHelpers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, we define a <code>create_user</code> helper method that creates a <code>User</code> instance with default attributes and merges any provided attributes. We then include this helper module in our RSpec configuration, making it available in all our tests.</p>
<p>With test helpers, you can DRY up your test code and make it more expressive:</p>
<div class="language-ruby codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ruby codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># spec/models/user_spec.rb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">require &#x27;spec_helper&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RSpec.describe User do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  describe &#x27;#name&#x27; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    it &#x27;returns the user name&#x27; do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      user = create_user(name: &#x27;Jane Doe&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      expect(user.name).to eq(&#x27;Jane Doe&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="136-continuous-integration">13.6. Continuous Integration<a href="#136-continuous-integration" class="hash-link" aria-label="Direct link to 13.6. Continuous Integration" title="Direct link to 13.6. Continuous Integration">​</a></h2>
<p>To ensure the reliability and maintainability of your CouchbaseOrm-based application, it&#x27;s recommended to set up continuous integration (CI) for running your tests automatically on each code change.</p>
<p>Popular CI services like Travis CI, CircleCI, or GitHub Actions can be easily integrated with your project. They can automatically run your test suite, report test results, and notify you of any failures.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="github-actions">GitHub Actions<a href="#github-actions" class="hash-link" aria-label="Direct link to GitHub Actions" title="Direct link to GitHub Actions">​</a></h3>
<p>GitHub Actions is a popular CI/CD platform that integrates seamlessly with GitHub repositories. It allows you to define workflows that automatically run your tests, perform code analysis, and deploy your application.</p>
<p>Here&#x27;s an example configuration for GitHub Actions:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># .github/workflows/ci.yml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">push</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">main</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">pull_request</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">main</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">test</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/checkout@v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Set up Ruby</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ruby/setup</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ruby@v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">ruby-version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Install dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          sudo apt-get update</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          sudo apt-get install -y libcouchbase-dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          gem install bundler</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          bundle install --jobs 4 --retry 3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Set up Couchbase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          curl -O http://packages.couchbase.com/releases/couchbase-release/couchbase-release-1.0-amd64.deb</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          sudo dpkg -i couchbase-release-1.0-amd64.deb</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          sudo apt-get update</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          sudo apt-get install -y couchbase-server</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Start Couchbase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sudo systemctl start couchbase</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Run tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> bundle exec rspec</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This GitHub Actions workflow defines a job named <code>test</code> that runs on Ubuntu. It performs the following steps:</p>
<ol>
<li>Checks out the code from the repository.</li>
<li>Sets up the specified Ruby version using the <code>ruby/setup-ruby</code> action.</li>
<li>Installs the required dependencies, including <code>libcouchbase-dev</code> and the project&#x27;s gems using Bundler.</li>
<li>Sets up Couchbase Server by downloading and installing the necessary packages.</li>
<li>Starts the Couchbase Server service.</li>
<li>Runs the RSpec tests using the <code>bundle exec rspec</code> command.</li>
</ol>
<p>This workflow will be triggered on every push to the <code>main</code> branch and every pull request targeting the <code>main</code> branch.</p>
<p>To use this workflow, create a new file named <code>ci.yml</code> in the <code>.github/workflows</code> directory of your project and copy the above configuration.</p>
<p>GitHub Actions provides a wide range of options and integrations, allowing you to customize your CI/CD pipeline according to your project&#x27;s needs. You can add additional steps for code coverage reporting, linting, or deploying your application to various environments.</p>
<p>By setting up continuous integration with GitHub Actions, you can automatically run your tests on each code change, ensuring that your CouchbaseOrm-based application remains stable and reliable.</p>
<p>Remember to configure your Couchbase connection details and any other necessary environment variables in the GitHub Actions secrets to keep sensitive information secure.</p>
<p>With continuous integration in place, you can catch issues early, maintain code quality, and deploy your application with confidence.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="travis-ci">Travis CI<a href="#travis-ci" class="hash-link" aria-label="Direct link to Travis CI" title="Direct link to Travis CI">​</a></h3>
<p>Here&#x27;s an example configuration for Travis CI:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># .travis.yml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">language</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ruby</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">rvm</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> couchbase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">before_script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> curl </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">O http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//packages.couchbase.com/releases/couchbase</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">release/couchbase</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">release</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1.0</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">amd64.deb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> sudo dpkg </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">i couchbase</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">release</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1.0</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">amd64.deb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> sudo apt</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">get update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> sudo apt</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">get install couchbase</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> sudo systemctl start couchbase</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> bundle exec rspec</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This configuration sets up a Ruby environment, installs Couchbase Server, and runs your RSpec tests on each build.</p>
<p>Testing is crucial for ensuring the correctness and reliability of your CouchbaseOrm-based application. By writing comprehensive tests for your models, queries, and interactions with Couchbase, you can catch bugs early, prevent regressions, and maintain a high-quality codebase.</p>
<p>In the next section, we&#x27;ll explore advanced topics in CouchbaseOrm, such as transactions, concurrency, and error handling.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/couchbase-examples/ruby-couchbase-orm-quickstart/tree/docs/docusaurus/docusaurus/docs/docs/tutorial-ruby-couchbase-orm/13-testing.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/logging"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Logging</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ruby-couchbase-orm-quickstart/docs/tutorial-ruby-couchbase-orm/advanced-topics"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Advanced Topics</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#131-setup" class="table-of-contents__link toc-highlight">13.1. Setup</a></li><li><a href="#132-model-tests" class="table-of-contents__link toc-highlight">13.2. Model Tests</a></li><li><a href="#133-query-tests" class="table-of-contents__link toc-highlight">13.3. Query Tests</a></li><li><a href="#134-mocking-couchbase-responses" class="table-of-contents__link toc-highlight">13.4. Mocking Couchbase Responses</a></li><li><a href="#135-test-helpers" class="table-of-contents__link toc-highlight">13.5. Test Helpers</a></li><li><a href="#136-continuous-integration" class="table-of-contents__link toc-highlight">13.6. Continuous Integration</a><ul><li><a href="#github-actions" class="table-of-contents__link toc-highlight">GitHub Actions</a></li><li><a href="#travis-ci" class="table-of-contents__link toc-highlight">Travis CI</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/ruby-couchbase-orm-quickstart/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>